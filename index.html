<element name="racer-element" attributes="at">
  <template>
    <content></content>
  </template>
  <script>
    Polymer.register(this,{trigger:function(){var t,i,e=arguments[0],s=[].slice.call(arguments,1);t=e.split(":").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join(""),(i=this["on"+t])&&i.apply(this,s),this.fire(e,s)},on:function(t,i){this.addEventListener(t,function(t){i.apply({},t.detail)})},set child(t){for(;this.firstElementChild;)this.removeChild(this.firstElementChild);this.appendChild(t),this.update()},get child(){return this.firstElementChild},set racer(t){var i=this;t.ready(function(t){i.model=t})},set model(t){var i=this;this._model=t,this.child||(this.child=document.createElement(this.childType||"div"),this.child.model||(this.child.model={})),this.listen(),t.get(this.at)?this.trigger("model:load"):t.subscribe(this.at,function(){i.trigger("model:load")})},get model(){return this._model},resolve:function(t){var i=[];return this.at&&i.push(this.at),t&&i.push(t),i.length>0?i.join("."):null},del:function(t){this._model.del(this.resolve(t)),this.fire("delete")},set:function(t,i){this._model.set(this.resolve(t),i)},onChildSave:function(){this.save()},onChildDelete:function(){this.del()},listen:function(){var t=this;this.turbo||this.child.addEventListener("save",function(i){i.stopPropagation(),t.onChildSave()}),this.child.addEventListener("delete",function(i){i.stopPropagation(),t.onChildDelete()}),this._model.on("all","**",function(i,e,s,n){var h=[e,i,s,n];if(t.at&&""!==t.at){if(0!==i.indexOf(t.at))return;i===t.at?h.splice(1,1):h[1]=h[1].replace(t.at+".","")}t.trigger.apply(t,h)})},update:function(t){var t,i;if(this.child&&this.child.model&&this._model){t=t||this._model.get();for(i in t)this.child.model[i]=t[i]}},save:function(){var t;for(t in this.child.model)this.set(t,this.child.model[t]);this.fire("save")},reset:function(){this.child.model=this._model.get(this.at)},onModelLoad:function(){this.update()},onChange:function(t,i){this.child&&(this.child.model[t]=i)}});
  </script>
</element>
