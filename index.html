<polymer-element name="racer-element" attributes="at">
  <script>
    Polymer("racer-element",{query:{},at:null,trigger:function(){var t,i,e=arguments[0],s=[].slice.call(arguments,1);t=e.split(":").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join(""),(i=this["on"+t])&&i.apply(this,s),this.fire(e,s)},on:function(t,i){this.addEventListener(t,function(t){i.apply({},t.detail)})},set child(t){for(;this.firstElementChild;)this.removeChild(this.firstElementChild);this.appendChild(t),this.update()},get child(){return this.firstElementChild},set racer(t){var i=this;t.ready(function(t){i.model=t})},set model(t){var i=this;this._model=t,this.child||(this.child=document.createElement(this.childType||"div"),this.child.model||(this.child.model={})),t.get(this.at)?this.trigger("model:load"):t.subscribe(this.at,function(){i.trigger("model:load")})},get model(){return this._model},resolve:function(t){var i=[];return this.at&&i.push(this.at),t&&i.push(t),i.length>0?i.join("."):null},del:function(t){this._model.pass({local:!0}).del(this.resolve(t))},set:function(t,i){this._model.pass({local:!0}).set(this.resolve(t),i)},get:function(t){return this._model.get(this.resolve(t))},onChildSave:function(){this.save()},onChildDelete:function(){this.del()},listen:function(t){var i=this;this.turbo||this.child.addEventListener("save",function(t){t.stopPropagation(),i.onChildSave(),i.fire("save")}),this.child.addEventListener("delete",function(t){t.stopPropagation(),i.onChildDelete(),i.fire("delete")}),t||(t=this._model),t.on("all","**",function(t,e,s,n){i.trigger.call(i,e,t,s,n)})},update:function(t){var t,i;if(this.child&&this.child.model&&this._model){t=t||this._model.get();for(i in t)this.child.model[i]=t[i]}},save:function(){var t,i;for(t in this.child.model)i=this.child.model[t],this.get(t)!==i&&this.set(t,i)},reset:function(){this.child.model=this._model.get(this.at)},onModelLoad:function(){this.listen(),this.update()},onChange:function(t,i){this.child&&(this.child.model[t]=i)}});
  </script>
</polymer-element>
